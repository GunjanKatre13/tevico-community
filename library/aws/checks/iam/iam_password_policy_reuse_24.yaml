Provider: aws
CheckID: iam_password_policy_reuse_24
CheckTitle: Ensure IAM password policy prevents password reuse between 1 and 24
CheckType: []
ServiceName: iam
SubServiceName: ""
ResourceIdTemplate: arn:aws:iam::account-id:password-policy
Severity: medium
ResourceType: IAM Password Policy
Description: |
  Ensure that the IAM password policy enforces password reuse prevention between 1 and 24. 
  This policy helps enhance security by preventing users from reusing their recent passwords.
Risk: |
  Without password reuse restrictions, users might recycle old passwords frequently, increasing security risks. 
  It is recommended to enforce a password history of at least 1 and up to 24 previous passwords to prevent weak security practices.
RelatedUrl: "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html"
Remediation:
  Code:
    CLI: |
      aws iam update-account-password-policy --password-reuse-prevention <value_between_1_and_24>
    NativeIaC: ""
    Other: ""
    Terraform: |
      resource "aws_iam_account_password_policy" "strict" {
        password_reuse_prevention = <value_between_1_and_24>
      }
  Recommendation:
    Text: Ensure "Number of passwords to remember" is set between 1 and 24.
    Url: "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html"
Categories: ["Security", "IAM"]
DependsOn: []
RelatedTo: ["IAM Security Best Practices"]
Notes: "This check ensures compliance with AWS security best practices for password policies."
