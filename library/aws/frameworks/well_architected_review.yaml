name: AWS | Well Architected Review

version: 1.0.0

description: |
  Well-Architected Review is a comprehensive assessment framework developed by AWS to help organizations evaluate their
  cloud architectures against a set of best practices. It provides a structured approach to identify areas for improvement
  and ensure that cloud-based applications are designed, built, and operated in a reliable, secure, efficient, and
  cost-effective manner.

  1. Operational Excellence
  2. Security
  3. Reliability
  4. Performance Efficiency
  5. Cost Optimization
  6. Sustainability

  https://aws.amazon.com/architecture/well-architected/

sections:
  - name: AWS | Well Architechted Review | Operational Excellence
    description: |
      The Security pillar includes the ability to protect information, systems, and assets while delivering business
      value through risk assessments and mitigation strategies.

      This section checks for the presence of a Well Architected Review in the AWS account.
    checks: []

  - name: AWS | Well Architechted Review | Reliability
    description: |
      The Reliability pillar includes the ability of a system to recover from infrastructure or service disruptions,
      dynamically acquire computing resources to meet demand, and mitigate disruptions such as misconfigurations or transient
      network issues.

      This section checks for the presence of a Well Architected Review in the AWS account.
    checks:
      - cloudformation_stacks_termination_protection_enabled
      - dynamodb_tables_pitr_enabled
      - elb_logging_enabled
      - opensearch_service_domains_audit_logging_enabled
      - opensearch_service_domains_cloudwatch_logging_enabled
      # - rds_instance_backup_enabled
      # - rds_instance_deletion_protection
      # - rds_instance_enhanced_monitoring_enabled
      # - rds_instance_integration_cloudwatch_logs
      # - rds_instance_multi_az
      # - apigateway_restapi_logging_enabled
      # - apigatewayv2_api_access_logging_enabled
      # - awslambda_function_invoke_api_operations_cloudtrail_logging_enabled
      # - cloudtrail_cloudwatch_logging_enabled
    sections:
      - name: All RDS checks
        description: |
          The Reliability pillar includes the ability of a system to recover from infrastructure or service disruptions,
          dynamically acquire computing resources to meet demand, and mitigate disruptions such as misconfigurations or transient
          network issues.

          This section checks for the presence of a Well Architected Review in the AWS account.
        checks:
          - rds_instance_backup_enabled
          - rds_instance_deletion_protection
          - rds_instance_enhanced_monitoring_enabled
          - rds_instance_integration_cloudwatch_logs
          - rds_instance_multi_az

  - name: AWS | Well Architechted Review | Performance Efficiency
    description: |
      The Performance Efficiency pillar includes the ability to use computing resources efficiently to meet system
      requirements and to maintain that efficiency as demand changes and technologies evolve.

      This section checks for the presence of a Well Architected Review in the AWS account.
    checks: []

  - name: AWS | Well Architechted Review | Cost Optimization
    description: |
      The Cost Optimization pillar includes the ability to avoid or eliminate unneeded cost or suboptimal resources.

      This section checks for the presence of a Well Architected Review in the AWS account.
    checks: []


  - name: AWS | Well Architechted Review | Operational Excellence
    description: |
      The Operational Excellence pillar includes the ability to run and monitor systems to deliver business value and to
      continually improve supporting processes and procedures.

      This section checks for the presence of a Well Architected Review in the AWS account.
    checks: []

  - name: AWS | Well Architechted Review | Secuirity
    description: |
      The Operational Excellence pillar includes the ability to run and monitor systems to deliver business value and to
      continually improve supporting processes and procedures.

      This section checks for the presence of a Well Architected Review in the AWS account.
    checks: 
     - iam_root_mfa_enabled
     - iam_no_root_access_keys
     - iam_password_policy_lowercase
     - iam_password_policy_minimum_length_14
     - iam_password_policy_number
     - iam_password_policy_symbol
     - iam_password_policy_uppercase
     - iam_password_policy_reuse_24
     - rds_instance_storage_encrypted
     - rds_instance_integration_cloudwatch_logging_enabled
     - networkfirewall_multi_az_enabled
     - rds_instance_minor_version_upgrade_enabled
     - route53_domains_privacy_protection_enabled
     - s3_bucket_default_encryption
     - s3_bucket_object_versioning
     - s3_bucket_secure_transport_policy
     - s3_bucket_no_mfa_delete
     - secrets_manager_automatic_rotation_enabled
     - securityhub_enabled
     - sns_topics_kms_encryption_at_rest_enabled
     - ssm_document_secrets_present
     - ssm_managed_compliant_patching
     - ssm_patch_manager_enabled
     - ssm_ec2instance_automatic_protection_check
     - ssm_ec2instance_remove_interactive_access_check
     - vpc_flowlogs_enable_logging
     - vpc_flowlogs_analyze_logs
     - vpc_default_security_group_closed
     - vpc_endpoint_services_allowed_principals_trust_boundaries
     - vpc_security_group_port_restriction_check
     - vpc_service_endpoint_enabled
     - vpc_flowlogs_traffic_inspection
     - wellarchitected_workload_no_high_or_medium_risks